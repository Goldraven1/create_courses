# Платформа обучающих курсов

Веб-приложение для создания и прохождения онлайн-курсов с системой авторизации, оплатой и административной панелью.

## Технический стек

- **Backend**: Flask, SocketIO, PostgreSQL
- **Frontend**: HTML, CSS, JavaScript
- **Аутентификация**: Flask-Login
- **Безопасность**: Flask-Limiter, Flask-IpBan
- **Мониторинг**: Prometheus, Grafana
- **Контейнеризация**: Docker, Docker Compose

## Установка и запуск

### С использованием Docker Compose

1. Клонируйте репозиторий:
```bash
git clone <url-репозитория>
cd create_courses
```

2. Запустите контейнеры:
```bash
docker-compose up -d
```

3. Приложение будет доступно по адресу `http://localhost:42125`
4. Grafana: `http://localhost:3000` (логин: admin, пароль: admin)
5. Prometheus: `http://localhost:9090`

### Локальный запуск (без Docker)

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Настройте подключение к базе данных в файле configus.py

3. Запустите приложение:
```bash
python hackathon1-main/main.py
```

## Структура базы данных

### Таблица users
- id (PK)
- username
- email
- password (хешированный)
- role
- confirmed (boolean)
- picture (путь к изображению)

### Таблица Courses
- course_id (PK)
- title
- description
- duration
- price
- levls (уровень сложности)
- category_id (FK)
- photos (путь к изображению)

## Мониторинг

Система мониторинга построена на базе Prometheus и Grafana. Основные метрики:

1. HTTP Requests Rate - количество запросов в минуту
2. Average Response Time - среднее время ответа в секундах
3. HTTP Exceptions - количество ошибок HTTP
4. Active Users - количество активных пользователей
5. Total HTTP Requests by Endpoint - общее количество запросов по конечным точкам

### Настройка мониторинга

1. Prometheus собирает метрики из приложения
2. Grafana визуализирует метрики через предустановленные дашборды
3. Автоматическая настройка через Docker Compose

## Безопасность

### Аутентификация и авторизация
- Система регистрации с подтверждением по электронной почте
- Хеширование паролей с использованием SHA-256
- Разделение прав доступа (администратор/пользователь)

### Защита от атак
- Ограничение количества запросов (rate limiting)
- Бан IP-адресов при превышении лимитов
- Защита от XSS и CSRF атак

### Валидация данных
- Проверка входных данных через регулярные выражения
- Ограничение размеров загружаемых файлов
- Проверка допустимых типов файлов

## API-эндпоинты

### Публичные эндпоинты
- `/` - главная страница
- `/login` - страница входа
- `/register` - страница регистрации
- `/courses` - список курсов
- `/about` - о проекте
- `/tos` - условия использования

### Защищенные эндпоинты (требуют аутентификации)
- `/profile/<username>` - профиль пользователя
- `/checkout` - страница оформления заказа
- `/radio` - радио-страница
- `/queue` - очередь

### Административные эндпоинты
- `/course_editor` - редактор курсов
- `/create_course` - создание нового курса

## Работа с файлами

### Загрузка изображений пользователя
- Поддерживаемые форматы: PNG, JPG, WEBP, SVG
- Максимальный размер: 20 КБ
- Автоматическое переименование файлов

## Масштабирование

Приложение готово для горизонтального масштабирования:
- Containerization с использованием Docker
- Оркестрация с использованием Docker Compose
- Выделенная база данных PostgreSQL
- Мониторинг производительности в реальном времени

## Обслуживание

### Резервное копирование
Данные PostgreSQL сохраняются в именованном томе Docker, что позволяет легко создавать резервные копии.

### Логирование
- Стандартные Flask логи
- Логирование соединений и действий пользователей
- Мониторинг активности пользователей

### Обновление
Для обновления приложения достаточно:
1. Остановить контейнеры: `docker-compose down`
2. Обновить код из репозитория: `git pull`
3. Запустить контейнеры: `docker-compose up -d`

## Предварительные требования

- Docker и Docker Compose
- Доступ в интернет для загрузки образов
- 2 ГБ оперативной памяти (минимум)
- 1 ГБ свободного места на диске

## Известные ограничения

- Отсутствует интеграция с платежными системами (только заготовка)
- Промокоды не реализованы (только пользовательский интерфейс)
- Ограничение на размер загружаемых файлов (20 КБ)
